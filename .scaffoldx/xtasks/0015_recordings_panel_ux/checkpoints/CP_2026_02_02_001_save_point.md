---
checkpoint_id: CP_2026_02_02_001
checkpoint_type: save_point
created: 2026-02-02T12:00:00.000Z
format_version: "1.0"
entity_type: task
entity_id: "0015"
entity_name: "Recordings Panel UX Improvements"
trigger: manual
trigger_reason: "Session handoff for Scrutinizer debugging"
user: "Henry"
environment: "windows"
priority: high
auto_load: true
---

# Save Point: RecordingsPanel Layout Issues

## Session Summary
Working on Task 0015 (Recordings Panel UX Improvements) with focus on card layout restructure. Using Scrutinizer role for debugging.

## Changes Made This Session

### Layout Structure Changes
- Reordered card layout: Line 1 = truncated transcription (bold), Line 2 = meta info, Line 3 = expandable full text
- Switched from BorderLayout to **GridBagLayout** for 2-column structure (infoPanel | buttonPanel)
- Added `expandedStates` HashMap to persist expanded state across window resize/refresh

### Files Modified
- `RecordingsPanel.java`:
  - `createRecordingCard()` - GridBagLayout with column constraints
  - `calculateMaxChars()` - Updated for 13pt bold font (8px/char instead of 6px)
  - Added `expandedStates` field for persistence
  - Added `buttonPanel.setMinimumSize(new Dimension(140, 30))`

## Pending Issues (Still Broken)

### 1. Width/Clipping Regression
- Expanded text still clips on right side (~200px)
- HTML labels ignore GridBagConstraints - calculate their own preferred size
- Text shifts right and pushes buttons off-screen

### 2. Buttons Disappear at Narrow Widths
- Even with GridBagLayout and minimum size, buttons vanish when window is narrow
- Screenshots show progression: normal -> wide (buttons far right) -> narrow (buttons gone)

### 3. Responsive Truncation Not Visible
- `calculateMaxChars()` should adjust truncation length on resize
- Title line length appears static despite resize events

## Scrutinizer Analysis

### Root Cause Hypothesis
HTML labels (`<html>...<div style='width:Xpx'>...</div></html>`) calculate preferred size from content, not container constraints. GridBagLayout tries to satisfy preferred sizes before distributing remaining space. If column 0's HTML label has large preferred width, column 1 gets squeezed.

### Kill Signals Identified
| Issue | Location | Problem |
|-------|----------|---------|
| HTML preferred size | titleLabel, fullTextLabel | Ignores layout constraints |
| contentPanel.getWidth() timing | calculateMaxChars() | May return stale/wrong value |
| Font metrics hardcoded | calculateMaxChars() line 157 | "8 pixels per char" is approximate |

### Potential Fixes to Try
1. **Don't use HTML for title** - plain text + separate [more] JLabel
2. **Set maxPreferredSize on labels** to constrain their requests
3. **Use JTextArea with word wrap** instead of HTML for full text
4. **Wrap infoPanel in JScrollPane** with horizontal scroll disabled

## Resume Instructions

1. Activate Scrutinizer role: `x-role-activate --as scrutinizer`
2. Load this checkpoint: `x-checkpoint-load CP_2026_02_02_001 --entity-type task --entity-id 0015`
3. Test current state: run app, expand recording, resize window
4. Focus on: Why do HTML labels break GridBagLayout constraints?

## Code Location Reference
- Card creation: RecordingsPanel.java:207-390
- Truncation calc: RecordingsPanel.java:150-159
- Expanded state: RecordingsPanel.java:39 (expandedStates HashMap)

## Current Checklist Status
See `.scaffoldx/xtasks/0015_recordings_panel_ux/03_checklist.md` for full checklist.

Remaining verification items:
- [ ] No UI overlap at any window size
- [ ] Button states provide clear feedback
- [ ] Full transcription viewable in-app
- [ ] Audio playback works reliably
- [ ] Manifest stays in sync with filesystem
